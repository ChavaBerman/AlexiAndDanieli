<p-treeTable *ngIf="reportDataTreeNodeList.length>0" [value]="reportDataTreeNodeList">
  <ng-template pTemplate="header">
      <tr>
          <th *ngFor="let col of cols">
              {{col.header}}
          </th>
      </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowNode let-rowData="rowData">
      <tr>
          <td *ngFor="let col of cols; let i = index">
              <p-treeTableToggler [rowNode]="rowNode" *ngIf="i == 0" ></p-treeTableToggler>
              <span>{{rowData[col.field]}}</span>    
          </td>

      </tr>
  </ng-template>
</p-treeTable>
  <form [formGroup]="formGroup" >
    <div class="form-item">
      <label for="month">Month</label>
      <select formControlName="month" (change)="selectFilterParameters()">
        <option *ngFor="let month of monthArray; let i=index" [ngValue]="i+1">{{month}}</option>
      </select>
    </div>
    <div class="form-item">
      <label for="teamHead">Team Head</label>
      <select formControlName="teamHead" (change)="selectFilterParameters()">
        <option *ngFor="let teamHead of teamHeadsArray" [ngValue]="teamHead.userName">{{teamHead.userName}}</option>
      </select>
    </div>
    <div class="form-item">
      <label for="project">Project</label>
      <select formControlName="project" (change)="selectFilterParameters()">
        <option *ngFor="let project of  projectsArray" [ngValue]="project.projectName">{{project.projectName}}</option>
      </select>
    </div>
    <div class="form-item">
      <label for="worker">Worker</label>
      <select formControlName="worker" (change)="selectFilterParameters()">
        <option *ngFor="let worker of workersArray" [ngValue]="worker.userName">{{worker.userName}}</option>
      </select>
    </div>
  </form>

<button (click)="generateExcel()">Export to Excel</button>